# 🤖 Project: 基于 RTX51 TINY 的麦克纳姆轮避障循迹小车

## 🌟 项目简介

本项目代号 **Project**，是基于经典的 **8051 微控制器**开发的麦克纳姆轮全向移动平台。

我们利用 **Keil RTX51 TINY 实时操作系统** 的高效、轻量级任务调度能力，实现了对**超声波避障**和**红外循迹**的精准并发控制。RTOS 的引入确保了小车在资源有限的 8 位平台上，具备最高的**实时响应速度**和**系统稳定性**。

---

## 🚀 核心技术栈与配置

| 类别 | 技术/组件 | 具体配置或说明 |
| :--- | :--- | :--- |
| **实时操作系统** | **Keil RTX51 TINY** | [cite_start]针对 8051 深度优化的精简版 RTOS，占用代码空间极小 [cite: 2, 23]。 |
| **微控制器** | 【例如：STC89C52RC 或 C8051Fxxx】 | 项目使用的 8 位单片机型号。 |
| **开发环境** | Keil C51 uVision | 编译器及集成开发环境。 |
| **系统定时器** | 8051 **定时器 0** | [cite_start]RTX51 TINY 默认使用 Timer 0 作为硬件时钟中断 [cite: 47, 49]。 |
| **避障模块** | 【超声波 HC-SR04】 | 实现实时距离测量。 |
| **循迹模块** | 【红外循迹传感器阵列】 | 实现路线追踪。 |

### ⚙️ RTX51 TINY 配置摘要 (Conf_tny.A51)

[cite_start]本项目使用的 RTX51 TINY 配置关键参数位于汇编文件 `Conf_tny.A51` 中 [cite: 41]：

* [cite_start]**硬件定时器时钟 (INT\_CLOCK):** `【例如：10000 周期】` [cite: 49]
* [cite_start]**时间片轮转 (TIMESHARING):** `【例如：5】` (表示 5 个时钟周期切换一次任务) [cite: 50]
* [cite_start]**CPU 栈顶 (RAMTOP):** 默认为 `0FFH`，即内部 RAM 最高地址 [cite: 62]。
* [cite_start]**最小空闲栈空间 (FREE\_STACK):** `【例如：20 字节】`，用于开启栈溢出检查 [cite: 63]。

---

## 💡 RTOS 在本项目中的意义 (任务与实时性)

RTX51 TINY 帮助我们将小车逻辑分解为独立的并发任务，确保了避障（安全）任务的最高实时响应。

| 任务名称 | 优先级 | 调度意义 |
| :--- | :--- | :--- |
| **T0：避障处理** | **3 (最高)** | 抢占式处理，确保传感器触发时，运动控制能**立即响应**，避免碰撞。 |
| **T1：运动控制** | **2 (中)** | 负责精确计算麦克纳姆轮的四轮速度和方向，**保证运动平稳性**。 |
| **T2：循迹逻辑** | **1 (低)** | 负责读取红外循迹传感器，并作为周期性任务，向运动控制任务发送校正指令。 |
| **T3：通信/遥控** | 0 (最低) | 处理用户输入，在系统空闲时进行，**不干扰核心实时功能**。 |

---

## 🛠️ 编译与烧录流程

### 1. 项目编译
1.  打开 Keil uVision，加载项目文件 `【Project】.uvproj`。
2.  确保 **`RTX51TNY.LIB`** 和配置启动文件 **`Conf_tny.A51`** 已正确链接。
3.  点击 **"Rebuild All Target Files"** (F7) 进行编译。
4.  生成的固件文件 `【Project】.hex` 位于 `【输出文件夹路径】`，用于烧录。

### 2. 使用 AICUBE-ISP 烧录固件

我们使用的是 **AICUBE-ISP** 工具将 `.hex` 文件写入单片机 Flash：

1.  将 AICUBE-ISP 烧录器连接至 PC 的 USB 端口，并连接到小车的 MCU 编程接口。
2.  打开 **AICUBE-ISP 软件**。
3.  在软件中选择正确的**芯片型号**。
4.  加载编译生成的 **`【Project】.hex`** 固件文件。
5.  确保单片机处于**下载模式**（如果需要）。
6.  点击软件中的 **“下载/烧录”** 按钮，等待烧录完成。

---


